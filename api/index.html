
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for Calva's API to other VS Code extensions (such as Joyride)">
      
      
      
        <link rel="canonical" href="https://calva.io/api/">
      
      
        <link rel="prev" href="../clj-java-decompiler/">
      
      
        <link rel="next" href="../jack-in-guide/">
      
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.16">
    
    
      
        <title>Extension API - Calva User Guide</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bcfcd587.min.css">
      
      


    
    
  
      
    
  
    <script defer data-domain="calva.io" src="https://plausible.io/js/script.js"></script>
  

    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","UA-69796730-5"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","UA-69796730-5",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=UA-69796730-5",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Extension API - Calva User Guide" >
      
        <meta  property="og:description"  content="Documentation for Calva's API to other VS Code extensions (such as Joyride)" >
      
        <meta  property="og:image"  content="https://calva.io/assets/images/social/api.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://calva.io/api/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Extension API - Calva User Guide" >
      
        <meta  name="twitter:description"  content="Documentation for Calva's API to other VS Code extensions (such as Joyride)" >
      
        <meta  name="twitter:image"  content="https://calva.io/assets/images/social/api.png" >
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-calva-extension-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Calva User Guide" class="md-header__button md-logo" aria-label="Calva User Guide" data-md-component="logo">
      
  <img src="../img/calva-symbol-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Calva User Guide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Extension API
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/BetterThanTomorrow/calva" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Calva
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Calva User Guide" class="md-nav__button md-logo" aria-label="Calva User Guide" data-md-component="logo">
      
  <img src="../img/calva-symbol-white.svg" alt="logo">

    </a>
    Calva User Guide
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/BetterThanTomorrow/calva" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Calva
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clojure Interactive Programming for Visual Studio Code
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Start Here
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Start Here
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get Started with Calva
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../connect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Connect the REPL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../try-first/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Try this First
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../finding-commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Finding Calva Commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eval-tips/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evaluate Clojure Code
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../why-calva/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Why you should consider Calva
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Features
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands-top10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Top 10 Commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../evaluation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evaluate Clojure Code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../formatting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clojure Formatting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../syntax-highlighting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clojure Syntax Highlighting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paredit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Paredit, a Visual Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Superb Clojure Linting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rich-comments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rich Comments Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fiddle-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fiddle Files Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../refactoring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Refactoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom-commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom REPL Commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../connect-sequences/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom REPL Connect Sequences
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clojure Notebooks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clojuredocs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ClojureDocs Integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../repl-window/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The REPL Window
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evaluation results and outher output
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../debugger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Debugger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pprint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pretty Printing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../test-runner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Runner
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../namespace-form-auto-creation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Namespace Form Auto-creation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hiccup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Converting HTML to Hiccup
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Customizing Calva
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Customizing Calva
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../customizing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Customizing Calva
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../customizing-jack-in-and-connect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Customize Jack-in and Connect
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../when-clauses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calva When Clause Contexts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../clojure-lsp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    clojure-lsp
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../nrepl_and_cider-nrepl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nREPL and cider-nrepl
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Using Calva with ...
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Using Calva with ...
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shadow-cljs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shadow-cljs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wsl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WSL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../remote-development/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VS Code Remote Development
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../live-share/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Live Share
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VIM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reveal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reveal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../babashka/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Babashka
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nbb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nbb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../joyride/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Joyride
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clojuredart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ClojureDart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../luminus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Luminus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../re-frame-template/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The re-frame template
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../polylith/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polylith
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../krell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Krell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rebl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REBL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../parinfer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parinfer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tips and Tricks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Tips and Tricks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../emacs-keybindings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Emacs Keybindings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workspace-layouts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workspace Layouts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quirks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quirks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../async-out/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Viewing Async Output with Shadow-CLJS and Node
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clj-java-decompiler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add custom commands for decompiling generated Clojure code
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Extension API
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Extension API
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#accessing" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#repl" class="md-nav__link">
    <span class="md-ellipsis">
      repl
    </span>
  </a>
  
    <nav class="md-nav" aria-label="repl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#replcurrentsessionkey" class="md-nav__link">
    <span class="md-ellipsis">
      repl.currentSessionKey()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replevaluatecode" class="md-nav__link">
    <span class="md-ellipsis">
      repl.evaluateCode()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="repl.evaluateCode()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#handling-output" class="md-nav__link">
    <span class="md-ellipsis">
      Handling Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ranges" class="md-nav__link">
    <span class="md-ellipsis">
      ranges
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ranges">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rangescurrentform" class="md-nav__link">
    <span class="md-ellipsis">
      ranges.currentForm()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rangescurrentenclosingform" class="md-nav__link">
    <span class="md-ellipsis">
      ranges.currentEnclosingForm()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rangescurrenttoplevelform" class="md-nav__link">
    <span class="md-ellipsis">
      ranges.currentTopLevelForm()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rangescurrentfunction" class="md-nav__link">
    <span class="md-ellipsis">
      ranges.currentFunction()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rangescurrenttopleveldef" class="md-nav__link">
    <span class="md-ellipsis">
      ranges.currentTopLevelDef()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-rangescurrenttoplevelform" class="md-nav__link">
    <span class="md-ellipsis">
      Example: ranges.currentTopLevelForm()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#editor" class="md-nav__link">
    <span class="md-ellipsis">
      editor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="editor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#editorreplace" class="md-nav__link">
    <span class="md-ellipsis">
      editor.replace()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#document" class="md-nav__link">
    <span class="md-ellipsis">
      document
    </span>
  </a>
  
    <nav class="md-nav" aria-label="document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#documentgetnamespacedocument-vscodetextdocument-string" class="md-nav__link">
    <span class="md-ellipsis">
      document.getNamespace(document?: vscode.TextDocument): string
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documentgetnamespaceandnsformdocument-vscodetextdocument-ns-string-nsform-string" class="md-nav__link">
    <span class="md-ellipsis">
      document.getNamespaceAndNsForm(document?: vscode.TextDocument): [ns: string, nsForm: string]
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pprint" class="md-nav__link">
    <span class="md-ellipsis">
      pprint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pprint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pprintprettyprint" class="md-nav__link">
    <span class="md-ellipsis">
      pprint.prettyPrint()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pprintprettyprintingoptions" class="md-nav__link">
    <span class="md-ellipsis">
      pprint.prettyPrintingOptions()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vscode" class="md-nav__link">
    <span class="md-ellipsis">
      vscode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="vscode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vscoderegisterdocumentsymbolprovider" class="md-nav__link">
    <span class="md-ellipsis">
      vscode.registerDocumentSymbolProvider()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#feedback-welcome" class="md-nav__link">
    <span class="md-ellipsis">
      Feedback Welcome
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    In Depth
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            In Depth
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jack-in-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Jack-in Academy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../get-started-with-clojure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get Started with Clojure
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tao/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Tao of Calva
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribute to Calva
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../sponsors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calva Sponsors
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../merch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calva T-shirts and Stickers!
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#accessing" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#repl" class="md-nav__link">
    <span class="md-ellipsis">
      repl
    </span>
  </a>
  
    <nav class="md-nav" aria-label="repl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#replcurrentsessionkey" class="md-nav__link">
    <span class="md-ellipsis">
      repl.currentSessionKey()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replevaluatecode" class="md-nav__link">
    <span class="md-ellipsis">
      repl.evaluateCode()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="repl.evaluateCode()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#handling-output" class="md-nav__link">
    <span class="md-ellipsis">
      Handling Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ranges" class="md-nav__link">
    <span class="md-ellipsis">
      ranges
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ranges">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rangescurrentform" class="md-nav__link">
    <span class="md-ellipsis">
      ranges.currentForm()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rangescurrentenclosingform" class="md-nav__link">
    <span class="md-ellipsis">
      ranges.currentEnclosingForm()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rangescurrenttoplevelform" class="md-nav__link">
    <span class="md-ellipsis">
      ranges.currentTopLevelForm()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rangescurrentfunction" class="md-nav__link">
    <span class="md-ellipsis">
      ranges.currentFunction()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rangescurrenttopleveldef" class="md-nav__link">
    <span class="md-ellipsis">
      ranges.currentTopLevelDef()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-rangescurrenttoplevelform" class="md-nav__link">
    <span class="md-ellipsis">
      Example: ranges.currentTopLevelForm()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#editor" class="md-nav__link">
    <span class="md-ellipsis">
      editor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="editor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#editorreplace" class="md-nav__link">
    <span class="md-ellipsis">
      editor.replace()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#document" class="md-nav__link">
    <span class="md-ellipsis">
      document
    </span>
  </a>
  
    <nav class="md-nav" aria-label="document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#documentgetnamespacedocument-vscodetextdocument-string" class="md-nav__link">
    <span class="md-ellipsis">
      document.getNamespace(document?: vscode.TextDocument): string
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documentgetnamespaceandnsformdocument-vscodetextdocument-ns-string-nsform-string" class="md-nav__link">
    <span class="md-ellipsis">
      document.getNamespaceAndNsForm(document?: vscode.TextDocument): [ns: string, nsForm: string]
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pprint" class="md-nav__link">
    <span class="md-ellipsis">
      pprint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pprint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pprintprettyprint" class="md-nav__link">
    <span class="md-ellipsis">
      pprint.prettyPrint()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pprintprettyprintingoptions" class="md-nav__link">
    <span class="md-ellipsis">
      pprint.prettyPrintingOptions()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vscode" class="md-nav__link">
    <span class="md-ellipsis">
      vscode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="vscode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vscoderegisterdocumentsymbolprovider" class="md-nav__link">
    <span class="md-ellipsis">
      vscode.registerDocumentSymbolProvider()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#feedback-welcome" class="md-nav__link">
    <span class="md-ellipsis">
      Feedback Welcome
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="the-calva-extension-api">The Calva Extension API<a class="headerlink" href="#the-calva-extension-api" title="Permanent link">#</a></h1>
<p>Calva exposes an API for use from other VS Code extensions (such as <a href="../joyride/">Joyride</a>). The API is in an experimental state, while we are figuring out what is a good shape for this API. It is also rather small, and will grow to expose more of Calva's functionality.</p>
<h2 id="accessing">Accessing<a class="headerlink" href="#accessing" title="Permanent link">#</a></h2>
<p>To access the API the Calva extension needs to be <a href="https://code.visualstudio.com/api/references/vscode-api#Extension%3CT%3E">activated</a>. The API is exposed under the <code>v1</code> key on the extension's <code>exports</code>, and split up into submodules, like <code>repl</code>, and <code>ranges</code>.</p>
<p>When using Joyride you can use its unique <code>require</code> API, for which one of the benefits is better lookup IDE support. When using the API from regular ClojureScript, you'll pick it up from the Calva extension instance. (Which you can do from Joyride as well, but why would you?). Here is how you access the API, with an example of usage as a bonus:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Joyride</label><label for="__tabbed_1_2">ClojureScript</label><label for="__tabbed_1_3">JavaScript</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="kd">ns </span><span class="nv">...</span><span class="w"> </span><span class="p">(</span><span class="ss">:require</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;ext://betterthantomorrow.calva$v1&quot;</span><span class="w"> </span><span class="ss">:as</span><span class="w"> </span><span class="nv">calva</span><span class="p">]))</span>
<span class="c1">;; OR</span>
<span class="p">(</span><span class="nf">require</span><span class="w"> </span><span class="o">&#39;</span><span class="p">[</span><span class="s">&quot;ext://betterthantomorrow.calva$v1&quot;</span><span class="w"> </span><span class="ss">:as</span><span class="w"> </span><span class="nv">calva</span><span class="p">])</span>

<span class="p">(</span><span class="nf">calva/repl.currentSessionKey</span><span class="p">)</span><span class="w"> </span><span class="nv">=&gt;</span><span class="w"> </span><span class="s">&quot;cljs&quot;</span><span class="w"> </span><span class="c1">; or &quot;clj&quot;, depending</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">def </span><span class="nv">calvaExt</span><span class="w"> </span><span class="p">(</span><span class="nf">vscode/extensions.getExtension</span><span class="w"> </span><span class="s">&quot;betterthantomorrow.calva&quot;</span><span class="p">))</span>

<span class="p">(</span><span class="k">def </span><span class="nv">calva</span><span class="w"> </span><span class="p">(</span><span class="nb">-&gt; </span><span class="nv">calvaExt</span>
<span class="w">             </span><span class="nv">.-exports</span>
<span class="w">             </span><span class="nv">.-v1</span>
<span class="w">             </span><span class="p">(</span><span class="nf">js-&gt;clj</span><span class="w"> </span><span class="ss">:keywordize-keys</span><span class="w"> </span><span class="nv">true</span><span class="p">)))</span>

<span class="p">((</span><span class="nf">get-in</span><span class="w"> </span><span class="nv">calva</span><span class="w"> </span><span class="p">[</span><span class="ss">:repl</span><span class="w"> </span><span class="ss">:currentSessionKey</span><span class="p">]))</span><span class="w"> </span><span class="nv">=&gt;</span><span class="w"> </span><span class="s">&quot;cljs&quot;</span><span class="w"> </span><span class="c1">; or &quot;clj&quot;, depending</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">calvaExt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">vscode</span><span class="p">.</span><span class="nx">extensions</span><span class="p">.</span><span class="nx">getExtension</span><span class="p">(</span><span class="s2">&quot;betterthantomorrow.calva&quot;</span><span class="p">);</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">calva</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">calvaExt</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">v1</span><span class="p">;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">sessionKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">calva</span><span class="p">.</span><span class="nx">repl</span><span class="p">.</span><span class="nx">currentSessionKey</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="repl"><code>repl</code><a class="headerlink" href="#repl" title="Permanent link">#</a></h2>
<p>The <code>repl</code> module provides access to Calva's REPL connection.</p>
<h3 id="replcurrentsessionkey"><code>repl.currentSessionKey()</code><a class="headerlink" href="#replcurrentsessionkey" title="Permanent link">#</a></h3>
<p>Use <code>repl.currentSessionKey()</code> find out which REPL/session Calva's REPL is currently connected to (depends on the active file). Returns either <code>"clj"</code>, or <code>"cljs"</code>, or <code>nil</code> if no REPL is connected.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Joyride</label><label for="__tabbed_2_2">ClojureScript</label><label for="__tabbed_2_3">JavaScript</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">def </span><span class="nv">session-key</span><span class="w"> </span><span class="p">(</span><span class="nf">calva/repl.currentSessionKey</span><span class="p">))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">def </span><span class="nv">session-key</span><span class="w"> </span><span class="p">((</span><span class="nf">get-in</span><span class="w"> </span><span class="p">[</span><span class="ss">:repl</span><span class="w"> </span><span class="ss">:currentSessionKey</span><span class="p">]</span><span class="w"> </span><span class="nv">calvaApi</span><span class="p">)))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">sessionKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">calva</span><span class="p">.</span><span class="nx">repl</span><span class="p">.</span><span class="nx">currentSessionKey</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="replevaluatecode"><code>repl.evaluateCode()</code><a class="headerlink" href="#replevaluatecode" title="Permanent link">#</a></h3>
<p>This function lets you evaluate Clojure code through Calva's nREPL connection. Calling it returns a promise that resolves to a <code>Result</code> object. It's signature looks like so (TypeScript):</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">evaluateCode</span><span class="p">(</span>
<span class="w">  </span><span class="nx">sessionKey</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;clj&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;cljs&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;cljc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">undefined</span><span class="p">,</span>
<span class="w">  </span><span class="nx">code</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">  </span><span class="nx">ns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;user&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">output</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">stdout</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">m</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">    </span><span class="nx">stderr</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">m</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nx">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Result</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div>
<p>Where <code>Result</code> is:</p>
<div class="highlight"><pre><span></span><code><span class="kr">type</span><span class="w"> </span><span class="nx">Result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">result</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">ns</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">output</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">errorOutput</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<p>As you can see, the required arguments to the function are <code>sessionKey</code> and <code>code</code>. <code>sessionKey</code> should be <code>"clj"</code>, <code>"cljs"</code>, <code>"cljc"</code>, or <code>undefined</code> depending on which of Calva's REPL sessions/connections that should be used. It will depend on your project, and how you connect to it, which session keys are valid. Use <code>cljc</code> to request whatever REPL session <code>"cljc"</code> files are connected to. Use <code>undefined</code> to use the current REPL connection Calva would use (depends on which file is active).</p>
<p>An example:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:3"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Joyride</label><label for="__tabbed_3_2">ClojureScript</label><label for="__tabbed_3_3">JavaScript</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">p/let</span><span class="w"> </span><span class="p">[</span><span class="nv">evaluation</span><span class="w"> </span><span class="p">(</span><span class="nf">calva/repl.evaluateCode</span><span class="w"> </span><span class="s">&quot;clj&quot;</span><span class="w"> </span><span class="s">&quot;(+ 2 40)&quot;</span><span class="p">)]</span>
<span class="w">      </span><span class="p">(</span><span class="nb">println </span><span class="p">(</span><span class="nf">.-result</span><span class="w"> </span><span class="nv">evaluation</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">p/catch</span><span class="w"> </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">e</span><span class="p">]</span>
<span class="w">               </span><span class="p">(</span><span class="nb">println </span><span class="s">&quot;Evaluation error:&quot;</span><span class="w"> </span><span class="nv">e</span><span class="p">))))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">def </span><span class="nv">evaluate</span><span class="w"> </span><span class="p">(</span><span class="nf">get-in</span><span class="w"> </span><span class="p">[</span><span class="ss">:repl</span><span class="w"> </span><span class="ss">:evaluateCode</span><span class="p">]</span><span class="w"> </span><span class="nv">calvaApi</span><span class="p">))</span>
<span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">p/let</span><span class="w"> </span><span class="p">[</span><span class="nv">evaluation</span><span class="w"> </span><span class="p">(</span><span class="nf">evaluate</span><span class="w"> </span><span class="s">&quot;clj&quot;</span><span class="w"> </span><span class="s">&quot;(+ 2 40)&quot;</span><span class="p">)]</span>
<span class="w">      </span><span class="p">(</span><span class="nb">println </span><span class="p">(</span><span class="nf">.-result</span><span class="w"> </span><span class="nv">evaluation</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">p/catch</span><span class="w"> </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">e</span><span class="p">]</span>
<span class="w">               </span><span class="p">(</span><span class="nb">println </span><span class="s">&quot;Evaluation error:&quot;</span><span class="w"> </span><span class="nv">e</span><span class="p">))))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">evaluation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">calvaApi</span><span class="p">.</span><span class="nx">repl</span><span class="p">.</span><span class="nx">evaluateCode</span><span class="p">(</span><span class="s2">&quot;clj&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(+ 2 40)&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">evaluation</span><span class="p">.</span><span class="nx">result</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Evaluation error:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">e</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<h4 id="handling-output">Handling Output<a class="headerlink" href="#handling-output" title="Permanent link">#</a></h4>
<p>The <code>output</code> member on the <code>Result</code> object will have any output produced during evaluation. (The <code>errorOutput</code> member should contain error output produced, but currently some Calva bug makes this not work.) By default the stdout and stderr output is not printed anywhere.</p>
<p>If you want to do something with either regular output or error output during, or after, evaluation, you'll need to provide the <code>output</code> argument to <code>evaluateCode()</code>. (The <code>stderr</code> callback function works, so this is the only way to get at any error output, until the above mentioned Calva bug is fixed.)</p>
<p>An example:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:3"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><input id="__tabbed_4_3" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Joyride</label><label for="__tabbed_4_2">ClojureScript</label><label for="__tabbed_4_3">JavaScript</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">def </span><span class="nv">oc</span><span class="w"> </span><span class="p">(</span><span class="nf">joyride.core/output-channel</span><span class="p">))</span><span class="w"> </span><span class="c1">;; Assuming Joyride is used</span>
<span class="p">(</span><span class="k">def </span><span class="nv">evaluate</span><span class="w"> </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">code</span><span class="p">]</span>
<span class="w">                </span><span class="p">(</span><span class="nf">calva/repl.evaluateCode</span>
<span class="w">                 </span><span class="s">&quot;clj&quot;</span>
<span class="w">                 </span><span class="nv">code</span>
<span class="w">                 </span><span class="s">&quot;user&quot;</span>
<span class="w">                 </span><span class="o">#</span><span class="nv">js</span><span class="w"> </span><span class="p">{</span><span class="ss">:stdout</span><span class="w"> </span><span class="o">#</span><span class="p">(</span><span class="nf">.append</span><span class="w"> </span><span class="nv">oc</span><span class="w"> </span><span class="nv">%</span><span class="p">)</span>
<span class="w">                      </span><span class="ss">:stderr</span><span class="w"> </span><span class="o">#</span><span class="p">(</span><span class="nf">.append</span><span class="w"> </span><span class="nv">oc</span><span class="w"> </span><span class="p">(</span><span class="nb">str </span><span class="s">&quot;Error: &quot;</span><span class="w"> </span><span class="nv">%</span><span class="p">))})))</span>

<span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">p/let</span><span class="w"> </span><span class="p">[</span><span class="nv">evaluation</span><span class="w"> </span><span class="p">(</span><span class="nf">evaluate</span><span class="w"> </span><span class="s">&quot;(println :foo) (+ 2 40)&quot;</span><span class="p">)]</span>
<span class="w">      </span><span class="p">(</span><span class="nf">.appendLine</span><span class="w"> </span><span class="nv">oc</span><span class="w"> </span><span class="p">(</span><span class="nb">str </span><span class="s">&quot;=&gt; &quot;</span><span class="w"> </span><span class="p">(</span><span class="nf">.-result</span><span class="w"> </span><span class="nv">evaluation</span><span class="p">))))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">p/catch</span><span class="w"> </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">e</span><span class="p">]</span>
<span class="w">               </span><span class="p">(</span><span class="nf">.appendLine</span><span class="w"> </span><span class="nv">oc</span><span class="w"> </span><span class="p">(</span><span class="nb">str </span><span class="s">&quot;Evaluation error: &quot;</span><span class="w"> </span><span class="nv">e</span><span class="p">)))))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">def </span><span class="nv">oc</span><span class="w"> </span><span class="p">(</span><span class="nf">joyride.core/output-channel</span><span class="p">))</span><span class="w"> </span><span class="c1">;; Assuming Joyride is used</span>
<span class="p">(</span><span class="k">def </span><span class="nv">evaluate</span><span class="w"> </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">code</span><span class="p">]</span>
<span class="w">                </span><span class="p">((</span><span class="nf">get-in</span><span class="w"> </span><span class="p">[</span><span class="ss">:repl</span><span class="w"> </span><span class="ss">:evaluateCode</span><span class="p">]</span><span class="w"> </span><span class="nv">calvaApi</span><span class="p">)</span>
<span class="w">                 </span><span class="s">&quot;clj&quot;</span>
<span class="w">                 </span><span class="nv">code</span>
<span class="w">                 </span><span class="s">&quot;user&quot;</span>
<span class="w">                 </span><span class="o">#</span><span class="nv">js</span><span class="w"> </span><span class="p">{</span><span class="ss">:stdout</span><span class="w"> </span><span class="o">#</span><span class="p">(</span><span class="nf">.append</span><span class="w"> </span><span class="nv">oc</span><span class="w"> </span><span class="nv">%</span><span class="p">)</span>
<span class="w">                      </span><span class="ss">:stderr</span><span class="w"> </span><span class="o">#</span><span class="p">(</span><span class="nf">.append</span><span class="w"> </span><span class="nv">oc</span><span class="w"> </span><span class="p">(</span><span class="nb">str </span><span class="s">&quot;Error: &quot;</span><span class="w"> </span><span class="nv">%</span><span class="p">))})))</span>

<span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">p/let</span><span class="w"> </span><span class="p">[</span><span class="nv">evaluation</span><span class="w"> </span><span class="p">(</span><span class="nf">evaluate</span><span class="w"> </span><span class="s">&quot;(println :foo) (+ 2 40)&quot;</span><span class="p">)]</span>
<span class="w">      </span><span class="p">(</span><span class="nf">.appendLine</span><span class="w"> </span><span class="nv">oc</span><span class="w"> </span><span class="p">(</span><span class="nb">str </span><span class="s">&quot;=&gt; &quot;</span><span class="w"> </span><span class="p">(</span><span class="nf">.-result</span><span class="w"> </span><span class="nv">evaluation</span><span class="p">))))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">p/catch</span><span class="w"> </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">e</span><span class="p">]</span>
<span class="w">               </span><span class="p">(</span><span class="nf">.appendLine</span><span class="w"> </span><span class="nv">oc</span><span class="w"> </span><span class="p">(</span><span class="nb">str </span><span class="s">&quot;Evaluation error: &quot;</span><span class="w"> </span><span class="nv">e</span><span class="p">)))))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">evaluate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">code</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">  </span><span class="nx">calvaApi</span><span class="p">.</span><span class="nx">repl</span><span class="p">.</span><span class="nx">evaluateCode</span><span class="p">(</span><span class="s2">&quot;clj&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">code</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;user&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">stdout</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nx">stderr</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">});</span>

<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">evaluation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">evaluate</span><span class="p">(</span><span class="s2">&quot;(println :foo) (+ 2 40)&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;=&gt;&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">evaluation</span><span class="p">.</span><span class="nx">result</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Evaluation error:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">e</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="ranges"><code>ranges</code><a class="headerlink" href="#ranges" title="Permanent link">#</a></h2>
<p>The <code>ranges</code> module contains functions for retreiving <a href="https://code.visualstudio.com/api/references/vscode-api#Range">vscode.Range</a>s and text for pieces of interest in a Clojure document.</p>
<p>All functions in this module have the following TypeScript signature:</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="nx">editor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">vscode</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">activeTextEditor</span><span class="p">,</span><span class="w"> </span><span class="nx">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">editor</span><span class="o">?</span><span class="p">.</span><span class="nx">selection</span><span class="o">?</span><span class="p">.</span><span class="nx">active</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="nx">vscode</span><span class="p">.</span><span class="nx">Range</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="p">];</span>
</code></pre></div>
<p>I.e. they expect a <a href="https://code.visualstudio.com/api/references/vscode-api#TextEditor">vscode.TextEditor</a> – defaulting to the currently active editor – and a <a href="https://code.visualstudio.com/api/references/vscode-api#Position">vscode.Position</a> – defaulting to the current active position in the editor (or the first active position if multiple selections/positions exist, and will return a tuple with the range, and the text for the piece of interest requested.</p>
<div class="admonition note">
<p class="admonition-title">Custom REPL Commands</p>
<p>The <code>ranges</code> function have corresponding <a href="../custom-commands/">REPL Snippets/Commands</a> substitution variables. It is the same implementation functions used in both cases.</p>
</div>
<p>The functions available are:</p>
<h3 id="rangescurrentform"><code>ranges.currentForm()</code><a class="headerlink" href="#rangescurrentform" title="Permanent link">#</a></h3>
<p>Retrieves information about the current form, as determined from the editor and position.</p>
<p><em>Corresponding <a href="../custom-commands/">REPL Snippet</a> variable: <code>$current-form</code>.</em></p>
<p>See also about Calva's <a href="https://www.youtube.com/watch?v=8ygw7LLLU1w">Current Form</a> on YouTube.</p>
<h3 id="rangescurrentenclosingform"><code>ranges.currentEnclosingForm()</code><a class="headerlink" href="#rangescurrentenclosingform" title="Permanent link">#</a></h3>
<p>The list/vector/etcetera form comtaining the current form.</p>
<p><em>Corresponding <a href="../custom-commands/">REPL Snippet</a> variable: <code>$enclosing-form</code>.</em></p>
<h3 id="rangescurrenttoplevelform"><code>ranges.currentTopLevelForm()</code><a class="headerlink" href="#rangescurrenttoplevelform" title="Permanent link">#</a></h3>
<p>The current top level form. Outside <code>(comment ...)</code> (Rich comments) forms this is most often (<code>(def ...), (defgn ...)</code>, etcetera. Inside Rich comments it will be the current immediate child to the <code>(comment ...)</code> form.</p>
<p><em>Corresponding <a href="../custom-commands/">REPL Snippet</a> variable: <code>$top-level-form</code>.</em></p>
<h3 id="rangescurrentfunction"><code>ranges.currentFunction()</code><a class="headerlink" href="#rangescurrentfunction" title="Permanent link">#</a></h3>
<p>The current function, i.e. the form in ”call position” of the closest enclosing list.</p>
<p><em>Corresponding <a href="../custom-commands/">REPL Snippet</a> variable: <code>$current-fn</code>.</em></p>
<h3 id="rangescurrenttopleveldef"><code>ranges.currentTopLevelDef()</code><a class="headerlink" href="#rangescurrenttopleveldef" title="Permanent link">#</a></h3>
<p>The symbol being defined by the current top level form. NB: Will stupidly assume it is the second form. I.e. it does not check that it is an actual definition, and will often return nonsense if used in Rich comments.</p>
<p><em>Corresponding <a href="../custom-commands/">REPL Snippet</a> variable: <code>$top-level-defined-symbol</code>.</em></p>
<h3 id="example-rangescurrenttoplevelform">Example: <code>ranges.currentTopLevelForm()</code><a class="headerlink" href="#example-rangescurrenttoplevelform" title="Permanent link">#</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="5:3"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><input id="__tabbed_5_3" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Joyride</label><label for="__tabbed_5_2">ClojureScript</label><label for="__tabbed_5_3">JavaScript</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">let </span><span class="p">[[</span><span class="nb">range </span><span class="nv">text</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="nf">calva/ranges.currentTopLevelForm</span><span class="p">)]</span>
<span class="w">  </span><span class="nv">...</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">let </span><span class="p">[[</span><span class="nb">range </span><span class="nv">text</span><span class="p">]</span><span class="w"> </span><span class="p">((</span><span class="nf">get-in</span><span class="w"> </span><span class="p">[</span><span class="ss">:ranges</span><span class="w"> </span><span class="ss">:currentTopLevelForm</span><span class="p">]))]</span>
<span class="w">  </span><span class="nv">...</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">range</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ranges</span><span class="p">.</span><span class="nx">currentTopLevelForm</span><span class="p">();</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="editor"><code>editor</code><a class="headerlink" href="#editor" title="Permanent link">#</a></h2>
<p>The <code>editor</code> module has facilites (well, a facility, so far) for editing Clojure documents.</p>
<h3 id="editorreplace"><code>editor.replace()</code><a class="headerlink" href="#editorreplace" title="Permanent link">#</a></h3>
<p>With <code>editor.replace()</code> you can replace a range in a Clojure editor with new text. The arguments are:</p>
<ul>
<li><code>editor</code>, a <code>vscode.TextEditor</code></li>
<li><code>range</code>, a <code>vscode.Range</code></li>
<li><code>newText</code>, a string</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Joyride</label><label for="__tabbed_6_2">JavaScript</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">p/let</span><span class="w"> </span><span class="p">[</span><span class="nv">top-level-form-range</span><span class="w"> </span><span class="p">(</span><span class="nb">first </span><span class="p">(</span><span class="nf">calva/ranges.currentTopLevelForm</span><span class="p">))</span>
<span class="w">            </span><span class="nv">_</span><span class="w"> </span><span class="p">(</span><span class="nf">calva/editor.replace</span><span class="w"> </span><span class="nv">vscode/window.activeTextEditor</span><span class="w"> </span><span class="nv">top-level-form-range</span><span class="w"> </span><span class="s">&quot;Some new text&quot;</span><span class="p">)]</span>
<span class="w">      </span><span class="p">(</span><span class="nb">println </span><span class="s">&quot;Text replaced!&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">p/catch</span><span class="w"> </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">e</span><span class="p">]</span>
<span class="w">               </span><span class="p">(</span><span class="nb">println </span><span class="s">&quot;Error replacing text:&quot;</span><span class="w"> </span><span class="nv">e</span><span class="p">))))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">topLevelRange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">calvaApi</span><span class="p">.</span><span class="nx">ranges</span><span class="p">.</span><span class="nx">currentTopLevelForm</span><span class="p">();</span>
<span class="nx">calva</span><span class="p">.</span><span class="nx">editor</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">topLevelRange</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Some new text&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">_</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Text replaced!&quot;</span><span class="p">))</span>
<span class="w">  </span><span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Error replacing text:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">e</span><span class="p">));</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="document"><code>document</code><a class="headerlink" href="#document" title="Permanent link">#</a></h2>
<p>The <code>document</code> module provides access to the Clojure/Calva aspects of VS Code <code>TextDocument</code>s.</p>
<h3 id="documentgetnamespacedocument-vscodetextdocument-string"><code>document.getNamespace(document?: vscode.TextDocument): string</code><a class="headerlink" href="#documentgetnamespacedocument-vscodetextdocument-string" title="Permanent link">#</a></h3>
<p><code>document.getNamespace()</code> returns the namespace of a document.</p>
<ul>
<li><code>document</code>, a <code>vscode.TextDocument</code> (defaults to the current active document)</li>
</ul>
<p>Example usage. To evaluate some code in the namespace of the current document:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Joyride</label><label for="__tabbed_7_2">JavaScript</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="nf">calva/repl.evaluateCode</span><span class="w"> </span><span class="s">&quot;clj&quot;</span><span class="w"> </span><span class="s">&quot;(+ 1 2 39)&quot;</span><span class="w"> </span><span class="p">(</span><span class="nf">calva/document.getNamespace</span><span class="p">))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nx">calva</span><span class="p">.</span><span class="nx">repl</span><span class="p">.</span><span class="nx">evaluateCode</span><span class="p">(</span><span class="s2">&quot;clj&quot;</span><span class="p">,</span><span class="w">  </span><span class="s2">&quot;(+ 1 2 39)&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">calva</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">getNamespace</span><span class="p">());</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="documentgetnamespaceandnsformdocument-vscodetextdocument-ns-string-nsform-string"><code>document.getNamespaceAndNsForm(document?: vscode.TextDocument): [ns: string, nsForm: string]</code><a class="headerlink" href="#documentgetnamespaceandnsformdocument-vscodetextdocument-ns-string-nsform-string" title="Permanent link">#</a></h3>
<p><code>document.getNamespaceAndNsForm()</code> returns the namespace and the <code>ns</code> form of a document as a tuple.</p>
<ul>
<li><code>document</code>, a <code>vscode.TextDocument</code> (defaults to the current active document)</li>
</ul>
<p>Example usage. To evaluate the <code>ns</code> form of the current document:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">Joyride</label><label for="__tabbed_8_2">JavaScript</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="nf">calva/repl.evaluateCode</span><span class="w"> </span><span class="s">&quot;clj&quot;</span><span class="w"> </span><span class="p">(</span><span class="nb">second </span><span class="p">(</span><span class="nf">calva/document.getNamespaceAndNsForm</span><span class="p">)))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nx">calva</span><span class="p">.</span><span class="nx">repl</span><span class="p">.</span><span class="nx">evaluateCode</span><span class="p">(</span><span class="s2">&quot;clj&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">calva</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">getNamespaceAndNsForm</span><span class="p">()[</span><span class="mf">1</span><span class="p">]);</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="pprint"><code>pprint</code><a class="headerlink" href="#pprint" title="Permanent link">#</a></h2>
<p>The <code>pprint</code> module lets you pretty print Clojure code/data using Calva's <a href="../pprint/">pretty printing</a> engine (which in turn uses <a href="https://github.com/kkinnear/zprint">zprint</a>).</p>
<h3 id="pprintprettyprint"><code>pprint.prettyPrint()</code><a class="headerlink" href="#pprintprettyprint" title="Permanent link">#</a></h3>
<p>Use <code>pprint.prettyPrint()</code> to pretty print some Clojure data using your Calva pretty printing options. It accepts these arguments:</p>
<ul>
<li><code>text</code>, a <code>string</code> with the text to pretty print</li>
<li><code>options</code>, a JavaScript object with <a href="../pprint/">pretty printing</a> options, this is optional and will default to the current settings.</li>
</ul>
<p>The function is synchronous and returns the prettified text.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">Joyride</label><label for="__tabbed_9_2">JavaScript</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="nb">println </span><span class="p">(</span><span class="nf">calva/pprint.prettyPrint</span><span class="w"> </span><span class="s">&quot;Some text&quot;</span><span class="p">)))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">calvaApi</span><span class="p">.</span><span class="nx">pprint</span><span class="p">.</span><span class="nx">prettyPrint</span><span class="p">();</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="pprintprettyprintingoptions"><code>pprint.prettyPrintingOptions()</code><a class="headerlink" href="#pprintprettyprintingoptions" title="Permanent link">#</a></h3>
<p>Use to get the current pretty printint options:</p>
<h2 id="vscode"><code>vscode</code><a class="headerlink" href="#vscode" title="Permanent link">#</a></h2>
<p>In the its <code>vscode</code> submodule, Calva exposes access to things from its own <code>vscode</code> module instance. It gets important in some situations.</p>
<h3 id="vscoderegisterdocumentsymbolprovider"><code>vscode.registerDocumentSymbolProvider()</code><a class="headerlink" href="#vscoderegisterdocumentsymbolprovider" title="Permanent link">#</a></h3>
<p>This is the <code>[vscode.languages](https://code.visualstudio.com/api/references/vscode-api#languages).registerDocumentSymbolProvider()</code> function from the Calva extension. Use it if you want to provide symbols for Clojure files together with the ones that Calva provides. (If you use the <code>vscode.languages.registerDocumentSymbolProvider()</code> function from your extension (or Joyride) you will provide a separate group.)</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:3"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><input id="__tabbed_10_3" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">Joyride</label><label for="__tabbed_10_2">ClojureScript</label><label for="__tabbed_10_3">JavaScript</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">joyride/extension-context</span><span class="p">)</span>
<span class="w">  </span><span class="nv">.-subscriptions</span>
<span class="w">  </span><span class="p">(</span><span class="nf">.push</span><span class="w"> </span><span class="p">(</span><span class="nf">calva/vscode.registerDocumentSymbolProvider</span><span class="w"> </span><span class="nv">...</span><span class="p">)))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="nb">-&gt; </span><span class="nv">yourExtensionContext</span>
<span class="w">  </span><span class="nv">.-subscriptions</span>
<span class="w">  </span><span class="p">(</span><span class="nf">.push</span><span class="w"> </span><span class="p">((</span><span class="nf">get-in</span><span class="w"> </span><span class="nv">calva</span><span class="w"> </span><span class="p">[</span><span class="ss">:vscode</span><span class="w"> </span><span class="ss">:registerDocumentSymbolProvider</span><span class="p">])</span><span class="w"> </span><span class="nv">...</span><span class="p">)))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nx">yourExtensionContext</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">calva</span><span class="p">.</span><span class="nx">vscode</span><span class="p">.</span><span class="nx">registerDocumentSymbolProvider</span><span class="p">(...));</span>
</code></pre></div>
</div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Deprecation candidate</p>
<p>VS Code is still creating a separate group, just with the same name as Calva's, so this API is not good for anything, and we will probably remove it.</p>
</div>
<h2 id="feedback-welcome">Feedback Welcome<a class="headerlink" href="#feedback-welcome" title="Permanent link">#</a></h2>
<p>Please let us know how you fare using this API. Either in the #calva or #joyride channels on Slack or via the issues/discussions sections on the repositories. (Whichever seems to apply best.)</p>







  
  



  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["search.share", "content.tabs.link"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.bd41221c.min.js"></script>
      
    
  </body>
</html>